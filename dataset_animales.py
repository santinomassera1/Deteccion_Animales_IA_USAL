# -*- coding: utf-8 -*-
"""Dataset-Animales.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1v2YAtXb2I7_3nFi8Ka84-2ym-EnboH36
"""



# Commented out IPython magic to ensure Python compatibility.
# %pip install ultralytics
from ultralytics import YOLO
import os

# Cargar un modelo pre-entrenado de YOLOv8 (por ejemplo, yolov8s.pt)
# 's' indica un modelo pequeño, adecuado para empezar y para detección en tiempo real.
model = YOLO('yolov8s.pt')

# Entrenar el modelo con el conjunto de datos coco128.yaml
# El entrenamiento se realizará por 20 épocas (epochs)
# El tamaño del lote (batch size) se establece en 16
# El conjunto de datos se especifica con el archivo coco128.yaml
results = model.train(data='coco128.yaml', epochs=20, batch=16)

print("Entrenamiento completado. Los resultados se guardarán en la carpeta 'runs/detect/train'.")

# Verificar si el archivo de pesos last.pt existe después del entrenamiento
weights_path = '/content/runs/detect/train/weights/last.pt'
if os.path.exists(weights_path):
    print(f"Archivo de pesos '{weights_path}' encontrado.")
else:
    print(f"Error: Archivo de pesos '{weights_path}' no encontrado después del entrenamiento.")

# Commented out IPython magic to ensure Python compatibility.
# %pip install ultralytics
from ultralytics import YOLO
import os

# Ruta al archivo de pesos entrenado
weights_path = '/content/runs/detect/train/weights/last.pt'

# Verificar si el archivo de pesos existe antes de intentar cargar el modelo
if os.path.exists(weights_path):
    print(f"Archivo de pesos '{weights_path}' encontrado. Cargando el modelo...")
    # Cargar el modelo entrenado
    model = YOLO(weights_path)

    # Evaluar el modelo en el conjunto de validación de coco128
    # Esto calculará métricas como mAP (mean Average Precision) para cada clase
    results = model.val()

    print("Evaluación completada.")
else:
    print(f"Error: Archivo de pesos '{weights_path}' no encontrado. Por favor, asegúrate de que el entrenamiento se completó correctamente y generó este archivo.")

# Commented out IPython magic to ensure Python compatibility.
# %pip install ultralytics
from ultralytics import YOLO
# Cargar el modelo entrenado
# Los pesos del modelo entrenado se guardan en la carpeta 'runs/detect/train'
# El archivo de pesos suele llamarse 'weights/best.pt' o 'weights/last.pt'
# Vamos a usar 'last.pt' que es el modelo de la última época entrenada
model = YOLO('/content/runs/detect/train/weights/last.pt')

# Evaluar el modelo en el conjunto de validación de coco128
# Esto calculará métricas como mAP (mean Average Precision) para cada clase
results = model.val()

print("Evaluación completada.")

import os

# Ruta donde se guardan los resultados del entrenamiento por defecto
results_path = '/content/runs/detect/train'

# Listar el contenido de la carpeta de resultados
if os.path.exists(results_path):
    print(f"Contenido de la carpeta '{results_path}':")
    for item in os.listdir(results_path):
        print(item)
else:
    print(f"La carpeta '{results_path}' no existe. El entrenamiento podría no haber comenzado correctamente o la ruta es incorrecta.")

# Commented out IPython magic to ensure Python compatibility.
# %pip install ultralytics

"""Ahora, descargaremos un conjunto de datos que contenga las clases de interés. Utilizaremos el conjunto de datos `coco128` como ejemplo, ya que contiene las clases "person", "cat", "dog", "horse", y "cow". Este conjunto de datos es pequeño y útil para empezar. Para un entrenamiento más robusto, se necesitaría un conjunto de datos más grande y diverso."""

from ultralytics import YOLO
import os

# Descargar el conjunto de datos COCO128 (una versión pequeña de COCO)
# YOLOv8 puede descargar automáticamente los conjuntos de datos al entrenar,
# pero este paso es para demostrar cómo se puede hacer manualmente si es necesario.
# En este caso, YOLOv8 lo descargará si no existe al iniciar el entrenamiento.
# data_path = 'coco128.yaml' # Esta línea se usará más adelante en el entrenamiento

print("El conjunto de datos coco128 será descargado automáticamente por YOLOv8 durante el entrenamiento si no se encuentra.")